CREATE TABLE IF NOT EXISTS `__EFMigrationsHistory` (
    `MigrationId` varchar(150) NOT NULL,
    `ProductVersion` varchar(32) NOT NULL,
    PRIMARY KEY (`MigrationId`)
);

CREATE TABLE `Customer` (
    `CustomerId` bigint NOT NULL AUTO_INCREMENT,
    `CustomerName` varchar(255) NOT NULL,
    `CustomerDescription` text NULL,
    `DateStart` datetime NULL,
    `DateEnd` datetime NULL,
    PRIMARY KEY (`CustomerId`)
);

CREATE TABLE `CustomerAddress` (
    `AddressId` bigint NOT NULL AUTO_INCREMENT,
    `CustomerId` bigint NOT NULL,
    `AddressName` varchar(255) NULL,
    `Latitude` float(10,6) NOT NULL,
    `Longitude` float(10,6) NOT NULL,
    `DateStart` datetime NULL,
    `DateEnd` datetime NULL,
    PRIMARY KEY (`AddressId`),
    CONSTRAINT `FK_CUSTOMER_ADDRESS_CUSTOMER` FOREIGN KEY (`CustomerId`) REFERENCES `Customer` (`CustomerId`) ON DELETE RESTRICT
);

CREATE TABLE `CustomerDiscount` (
    `DiscountId` bigint NOT NULL AUTO_INCREMENT,
    `CustomerId` bigint NOT NULL,
    `Name` varchar(255) NOT NULL,
    `Description` text NULL,
    `DateStart` datetime NULL,
    `DateEnd` datetime NULL,
    PRIMARY KEY (`DiscountId`),
    CONSTRAINT `FK_DISCOUNT_CUSTOMER` FOREIGN KEY (`CustomerId`) REFERENCES `Customer` (`CustomerId`) ON DELETE RESTRICT
);

CREATE TABLE `DiscountTime` (
    `TimeId` bigint NOT NULL AUTO_INCREMENT,
    `DiscountId` bigint NOT NULL,
    `DayWeek` int(11) NOT NULL,
    `StartTime` decimal(5,2) NULL,
    `EndTime` decimal(5,2) NULL,
    PRIMARY KEY (`TimeId`),
    CONSTRAINT `FK_DISCOUNT_TIMES_DISCOUNT` FOREIGN KEY (`DiscountId`) REFERENCES `CustomerDiscount` (`DiscountId`) ON DELETE RESTRICT
);

CREATE INDEX `IDX_CUSTOMER_NAME` ON `Customer` (`CustomerName`);

CREATE INDEX `IX_Customer_DateEnd` ON `Customer` (`DateEnd`);

CREATE INDEX `IX_CustomerAddress_DateEnd` ON `CustomerAddress` (`DateEnd`);

CREATE UNIQUE INDEX `Customer_AddressId_UNIQUE` ON `CustomerAddress` (`CustomerId`, `AddressId`);

CREATE INDEX `IX_CustomerDiscount_CustomerId` ON `CustomerDiscount` (`CustomerId`);

